/*! sample_blog 07-10-2014 */
var app=angular.module("app",["ngRoute","services","directives","controllers"]);app.config(["$routeProvider",function(a){a.when("/",{controller:"articlesCtrl",templateUrl:"templates/article-list.html",resolve:{articles:["article",function(a){return a.getArticles()}]}}),a.when("/article/:id",{controller:"articleCtrl",templateUrl:"templates/read-article.html",resolve:{currentArticle:["article","$route",function(a,b){return a.getById(b.current.params.id)}]}}),a.otherwise({redirectTo:"/"})}]),angular.module("controllers",["services"]).controller("articlesCtrl",["$scope","article","articles",function(a,b,c){a.articles=c,a.$on("article:create",function(){b.getArticles().then(function(b){a.articles=b})})}]).controller("articleCtrl",["$scope","article","$location","currentArticle",function(a,b,c,d){a.article=d,a.edit=function(){},a.save=function(){},a.remove=function(a){b.remove(a).then(function(){c.path("/")})}}]),angular.module("directives",["services"]).directive("articleSection",function(){return{restrict:"E",templateUrl:"templates/article.html",replace:!0,scope:{article:"="}}}).directive("createArticle",["template","$compile",function(a,b){return{restrict:"A",scope:{},controller:["$scope","article",function(a,b){a.article={},a.create=function(c){("keyup"===c.type&&13===c.keyCode||"click"===c.type)&&b.create(a.article)}}],link:function(c,d,e){d.click(function(){a.getTemplate(e.tmp).then(function(a){var d=b(a)(c);$("body").append(d),d.find(".close").click(function(){d.remove()}),c.$on("article:create",function(){d.remove()})})})}}}]),angular.module("services",[]).factory("article",["$http","$rootScope",function(a,b){return{getArticles:function(){return a.get("http://restik.herokuapp.com/post").then(function(a){return a.data})},create:function(c){c.date=new Date,a.post("http://restik.herokuapp.com/post",c).then(function(a){return b.$broadcast("article:create"),a})},remove:function(b){return a.delete("http://restik.herokuapp.com/post/"+b)},getById:function(b){return a.get("http://restik.herokuapp.com/post/"+b).then(function(a){return a.data})}}}]).factory("template",["$q","$http","$templateCache",function(a,b,c){return{getTemplate:function(d){return a.when(c.get(d)||b.get(d)).then(function(a){return angular.isObject(a)&&(a=c.put(d,a.data)),a})}}}]);